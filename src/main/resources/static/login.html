<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê¸°ìˆ™ì‚¬ í†µí•© ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <style>
        body {
            display: flex; justify-content: center; align-items: center; height: 100vh;
            background-color: #f0f2f5; font-family: 'Noto Sans KR', sans-serif; margin: 0;
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ (ì¢Œìš° ë¶„í• ) */
        .main-container {
            display: flex;
            width: 900px;
            height: 550px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        /* ì™¼ìª½: ê³µì§€ì‚¬í•­ ì˜ì—­ */
        .notice-section {
            flex: 1.2;
            background-color: #3498db; /* íŒŒë€ìƒ‰ ë°°ê²½ */
            color: white;
            padding: 40px;
            display: flex;
            flex-direction: column;
        }

        .notice-section h2 { margin-top: 0; font-size: 24px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 15px; }

        .notice-list {
            list-style: none; padding: 0; margin: 0;
            flex: 1; overflow-y: auto; /* ë‚´ìš© ë§ìœ¼ë©´ ìŠ¤í¬ë¡¤ */
        }

        .notice-item {
            background: rgba(255,255,255,0.1);
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 8px;
            transition: 0.3s;
        }
        .notice-item:hover { background: rgba(255,255,255,0.2); }

        .n-title { font-weight: bold; font-size: 16px; margin-bottom: 5px; }
        .n-date { font-size: 12px; opacity: 0.8; }
        .n-content { font-size: 14px; margin-top: 8px; line-height: 1.4; display: none; /* í´ë¦­ ì‹œ ë‚´ìš© ë³´ê¸° */ }
        .notice-item.active .n-content { display: block; } /* í™œì„±í™”ë˜ë©´ ë‚´ìš© ë³´ì„ */


        /* ì˜¤ë¥¸ìª½: ë¡œê·¸ì¸ í¼ ì˜ì—­ */
        .login-section {
            flex: 1;
            padding: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .login-box { width: 100%; max-width: 320px; text-align: center; }
        .login-box h2 { color: #333; margin-bottom: 30px; font-size: 26px; }

        /* ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ */
        input[type="text"], input[type="password"] {
            width: 100%; padding: 12px; margin: 8px 0;
            border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box;
            font-size: 14px;
        }

        /* ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .role-selector {
            display: flex; justify-content: center; gap: 30px; margin-bottom: 20px;
        }
        .role-selector label {
            display: flex; align-items: center; gap: 8px;
            font-weight: bold; cursor: pointer; font-size: 16px; color: #555;
        }
        input[type="radio"] { width: 18px; height: 18px; margin: 0; accent-color: #3498db; cursor: pointer; }

        button {
            width: 100%; padding: 14px; margin-top: 20px;
            background-color: #3498db; color: white; border: none;
            border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: bold;
            transition: 0.3s;
        }
        button:hover { background-color: #2980b9; }

        /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í…€ */
        .notice-list::-webkit-scrollbar { width: 6px; }
        .notice-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .notice-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
    </style>
</head>
<body>

<div class="main-container">
    <!-- ì™¼ìª½: ê³µì§€ì‚¬í•­ -->
    <div class="notice-section">
        <h2>ğŸ“¢ ì£¼ìš” ê³µì§€ì‚¬í•­</h2>
        <ul id="noticeList" class="notice-list">
            <li style="text-align:center; padding:20px;">ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li>
        </ul>
    </div>

    <!-- ì˜¤ë¥¸ìª½: ë¡œê·¸ì¸ -->
    <div class="login-section">
        <div class="login-box">
            <h2>ğŸ”‘ ê¸°ìˆ™ì‚¬ ì‹œìŠ¤í…œ</h2>

            <div class="role-selector">
                <label><input type="radio" name="role" value="STUDENT" checked> í•™ìƒ</label>
                <label><input type="radio" name="role" value="MANAGER"> ê´€ë¦¬ì</label>
            </div>

            <input type="text" id="id" placeholder="í•™ë²ˆ ë˜ëŠ” ì‚¬ë²ˆ (ID)">
            <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
            <button onclick="login()">ë¡œê·¸ì¸</button>
        </div>
    </div>
</div>

<script>
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ê³µì§€ì‚¬í•­ ë¶ˆëŸ¬ì˜¤ê¸°
    window.onload = function() {
        loadNotices();
    };

    async function loadNotices() {
        try {
            const response = await fetch('/api/notices'); // ê¸°ì¡´ì— ë§Œë“  API ì¬ì‚¬ìš©
            const notices = await response.json();
            const list = document.getElementById('noticeList');
            list.innerHTML = '';

            if (notices.length === 0) {
                list.innerHTML = '<li style="text-align:center; padding:20px;">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</li>';
                return;
            }

            // ìµœì‹  5ê°œë§Œ ë³´ì—¬ì£¼ê±°ë‚˜ ì „ì²´ ë³´ì—¬ì£¼ê¸°
            notices.forEach(n => {
                // ë‚ ì§œ í¬ë§·íŒ… (YYYY-MM-DDë§Œ í‘œì‹œ)
                const dateStr = n.regDate ? n.regDate.substring(0, 10) : '';

                const li = document.createElement('li');
                li.className = 'notice-item';
                // í´ë¦­ ì‹œ ë‚´ìš© í† ê¸€ (ì•„ì½”ë””ì–¸ íš¨ê³¼)
                li.onclick = function() { this.classList.toggle('active'); };

                li.innerHTML = `
                    <div class="n-title">
                        ${n.title}
                        <span style="float:right; font-size:12px; font-weight:normal;">${n.writer}</span>
                    </div>
                    <div class="n-date">${dateStr}</div>
                    <div class="n-content">${n.content}</div>
                `;
                list.appendChild(li);
            });
        } catch (error) {
            console.error("ê³µì§€ ë¡œë“œ ì‹¤íŒ¨:", error);
            document.getElementById('noticeList').innerHTML = '<li style="text-align:center;">ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</li>';
        }
    }

    async function login() {
        const id = document.getElementById("id").value;
        const password = document.getElementById("password").value;
        const role = document.querySelector('input[name="role"]:checked').value;

        if (!id || !password) {
            alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        try {
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id, password, role })
            });

            const result = await response.json();

            if (result.success) {
                if (result.role === 'STUDENT') {
                    window.location.href = '/student_main.html';
                } else if (result.role === 'MANAGER') {
                    window.location.href = '/manager_main.html';
                }
            } else {
                alert(result.message);
            }
        } catch (error) {
            console.error("Error:", error);
            alert("ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
    }
</script>

</body>
</html>